# 顯示邏輯說明 v1.2

## 📊 簡潔明確的三級顯示

### 規則很簡單

| 檔案數量 | 顯示方式 | 原因 |
|---------|---------|------|
| **1 個** | 🔔 個別通知 | 清楚看到每個變動 |
| **2-10 個** | 📋 檔案清單 | 列出所有檔案名稱 |
| **10+ 個** | 📂 資料夾結構 | 一眼看出哪些資料夾在變動 |

---

## 實際範例

### 範例 1: 1 個檔案 → 個別通知

```
✏️ 修改 族群檔案
📄 檔案: H型鋼-300x150.rfa
📂 路徑: 結構\鋼構\H型鋼-300x150.rfa
⏰ 時間: 2025/11/17 14:30:00
```

---

### 範例 2: 5 個檔案 → 檔案清單

```
📦 批次檔案變動 (共 5 個檔案)

📊 變動統計:
  📁 新增: 5 個

⏰ 時間範圍: 14:30:00 - 14:30:08

📋 檔案清單:
  📁 H型鋼-300x150.rfa
  📁 H型鋼-400x200.rfa
  📁 I型鋼-250x125.rfa
  📁 C型鋼-200x80.rfa
  📁 角鋼-100x100.rfa

💡 提示: 檢查是否為批次同步或上傳操作
```

---

### 範例 3: 10 個檔案 → 檔案清單 (臨界值)

```
📦 批次檔案變動 (共 10 個檔案)

📊 變動統計:
  📁 新增: 10 個

⏰ 時間範圍: 14:30:00 - 14:30:10

📋 檔案清單:
  📁 H型鋼-300x150.rfa
  📁 H型鋼-400x200.rfa
  📁 I型鋼-250x125.rfa
  📁 C型鋼-200x80.rfa
  📁 角鋼-100x100.rfa
  📁 槽鋼-150x75.rfa
  📁 T型鋼-200x200.rfa
  📁 方管-100x100.rfa
  📁 圓管-60.5.rfa
  📁 矩形管-150x100.rfa

💡 提示: 檢查是否為批次同步或上傳操作
```

---

### 範例 4: 15 個檔案 → 資料夾結構

```
📦 批次檔案變動 (共 15 個檔案)

📊 變動統計:
  📁 新增: 15 個

⏰ 時間範圍: 14:30:00 - 14:30:12

📂 資料夾結構:
📁 `結構\鋼構` - 10 個 (+10)
  📁 `結構\鋼構\H型鋼` - 6 個 (+6)
  📁 `結構\鋼構\I型鋼` - 4 個 (+4)
📁 `結構\RC` - 5 個 (+5)

💡 提示: 檢查是否為批次同步或上傳操作
📋 完整清單請查看程式日誌檔
```

---

### 範例 5: 50 個檔案 → 資料夾結構

```
📦 批次檔案變動 (共 50 個檔案)

📊 變動統計:
  📁 新增: 50 個

⏰ 時間範圍: 14:30:00 - 14:30:25

📂 資料夾結構:
📁 `結構\鋼構` - 30 個 (+30)
  📁 `結構\鋼構\H型鋼` - 15 個 (+15)
  📁 `結構\鋼構\I型鋼` - 10 個 (+10)
  📁 `結構\鋼構\其他` - 5 個 (+5)
📁 `結構\RC` - 15 個 (+15)
  📁 `結構\RC\柱` - 8 個 (+8)
  📁 `結構\RC\梁` - 7 個 (+7)
📁 `結構\基礎` - 5 個 (+5)

💡 提示: 檢查是否為批次同步或上傳操作
📋 完整清單請查看程式日誌檔
```

---

### 範例 6: 500 個檔案 → 資料夾結構 + 嚴重警告

```
🚨 大量檔案變動警告 (共 523 個檔案)

📊 變動統計:
  📁 新增: 350 個
  ✏️ 修改: 150 個
  🗑️ 刪除: 23 個

⏰ 時間範圍: 14:30:00 - 14:35:20

📂 資料夾結構:
📁 `結構\鋼構` - 280 個 (+200, ~70, -10)
  📁 `結構\鋼構\H型鋼` - 120 個 (+80, ~35, -5)
  📁 `結構\鋼構\I型鋼` - 85 個 (+60, ~20, -5)
  📁 `結構\鋼構\C型鋼` - 45 個 (+35, ~10)
  📁 `結構\鋼構\管材` - 30 個 (+25, ~5)
📁 `結構\RC` - 150 個 (+100, ~45, -5)
  📁 `結構\RC\柱` - 60 個 (+40, ~18, -2)
  📁 `結構\RC\梁` - 50 個 (+35, ~15)
  📁 `結構\RC\版` - 40 個 (+25, ~12, -3)
📁 `結構\基礎` - 50 個 (+30, ~18, -2)
📁 `結構\樓梯` - 28 個 (+15, ~10, -3)
📁 `結構\其他` - 15 個 (+5, ~7, -3)

⚠️ 重要提醒:
  • 這是非常大量的檔案變動
  • 請確認是否為預期的操作
  • 建議檢查:批次同步/備份/誤刪
  • 完整清單請查看程式日誌檔
```

---

## 💡 為什麼這樣設計?

### 1 個檔案 → 個別通知
- **原因**: 可能是重要的單一修改
- **好處**: 完整資訊,不會錯過任何細節

### 2-10 個 → 檔案清單
- **原因**: 數量少,可以看清楚每個檔案
- **好處**: 知道確切是哪些檔案變動了

### 10+ 個 → 資料夾結構
- **原因**: 太多檔案看不過來
- **好處**: 
  - 快速理解「哪些資料夾」在變動
  - 避免訊息太長
  - 一眼看出是否為批次同步

---

## 🎯 使用情境

### 日常工作
```
上午: 修改 1 個檔案 → 個別通知 ✅
下午: 上傳 5 個新檔案 → 看到 5 個檔案名稱 ✅
```

### 批次作業
```
同步族群庫: 50 個檔案 → 看到資料夾分佈 ✅
大量更新: 200 個檔案 → 知道主要變動在哪些資料夾 ✅
```

### 異常狀況
```
誤刪資料夾: 500+ 個檔案 → 🚨 立即警告 ✅
```

---

## 📋 符號說明

### 資料夾統計符號
- `+N` = 新增 N 個檔案
- `~N` = 修改 N 個檔案
- `-N` = 刪除 N 個檔案

### 範例解讀
```
📁 `結構\鋼構` - 280 個 (+200, ~70, -10)
```
- 這個資料夾總共有 280 個檔案變動
- 其中 200 個新增、70 個修改、10 個刪除

---

## 🔍 完整資訊在哪裡?

### Slack 訊息
- 1 個: 完整資訊 ✅
- 2-10 個: 所有檔案名稱 ✅
- 10+ 個: 資料夾摘要 + "請查看日誌"

### 程式日誌
**所有檔案的完整變動都記錄在日誌中!**

日誌檔位置: `Logs/2025-11-17.log`

即使是 1000 個檔案的批次變動,日誌中也有:
- 每個檔案的名稱
- 每個檔案的路徑
- 每個檔案的變動時間
- 每個檔案的操作類型

---

## 常見問題

### Q: 為什麼 10 個是分界點?

**A:** 10 個是 Slack 訊息的舒適閱讀上限:
- 10 個以內:一眼看完,不用捲動
- 超過 10 個:開始感覺訊息太長
- 資料夾結構更簡潔清楚

### Q: 可以改成其他數字嗎?

**A:** 可以!在 n8n workflow 的 Function Node 中修改:
```javascript
let showFileList = totalCount <= 10;  // 改成你要的數字
```

### Q: 資料夾結構會顯示幾個資料夾?

**A:** 
- 一般情況:前 10 個資料夾
- 超過 500 個檔案:前 15 個資料夾
- 按檔案數量排序,優先顯示變動最多的

### Q: 10 個檔案時會怎麼顯示?

**A:** 剛好 10 個檔案時,會顯示**檔案清單**,列出所有 10 個檔案名稱。

從第 11 個開始才切換成資料夾結構。

---

## 總結

### 設計理念
**簡單、清楚、實用**

- ✅ 少量檔案:看清楚每個檔案
- ✅ 大量檔案:理解資料夾結構
- ✅ 超大量:警告 + 摘要

### 核心優勢
1. **不會漏訊息** - 1 個檔案也會通知
2. **不會被洗版** - 1000 個檔案只有 1 則訊息
3. **資訊清晰** - 該詳細時詳細,該摘要時摘要
4. **完整記錄** - 日誌中有所有細節

---

**現在的顯示邏輯更簡潔易懂了!** 🎉
